version: 2


sources:
  - name: iasworld
    loaded_at_field: date_parse(wen, '%Y-%m-%d %H:%i:%s.0')
    tables:
      - name: aasysjur
      - name: addn
      - name: addrindx
      - name: aprval
      - name: asmt_all
        freshness:
          filter: &latest_taxyr taxyr >= date_format(current_date - interval '1' year, '%Y')
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
      - name: asmt_hist
      - name: cname
      - name: comdat
      - name: comnt
      - name: cvleg
      - name: cvown
      - name: cvtran
      - name: dedit
      - name: dweldat
      - name: enter
      - name: exadmn
      - name: exapp
      - name: excode
      - name: exdet
      - name: htagnt
      - name: htdates
      - name: htpar
        freshness:
          filter: *latest_taxyr
          warn_after: {count: 24, period: hour}
          error_after: {count: 48, period: hour}
      - name: land
      - name: legdat
      - name: lpmod
      - name: lpnbhd
      - name: oby
      - name: owndat
      - name: pardat
      - name: permit
        freshness:
          filter: date_format(date_parse(permdt, '%Y-%m-%d %H:%i:%s.0'), '%Y') >= date_format(current_date - interval '1' year, '%Y')
          warn_after: {count: 48, period: hour}
          error_after: {count: 72, period: hour}
      - name: rcoby
      - name: sales
      - name: splcom
      - name: valclass
