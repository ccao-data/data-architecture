models:
  - name: default.vw_pin_universe
    description: '{{ doc("vw_pin_universe") }}'

    columns:
      - name: class
        description: '{{ doc("shared_column_class") }}'
      - name: lat
        description: '{{ doc("shared_column_latitude") }}'
      - name: lon
        description: '{{ doc("shared_column_longitude") }}'
      - name: nbhd_code
        description: '{{ doc("shared_column_nbhd_code") }}'
      - name: pin
        description: '{{ doc("shared_column_pin") }}'
      - name: pin10
        description: '{{ doc("shared_column_pin10") }}'
      - name: tax_code
        description: '{{ doc("shared_column_tax_code") }}'
      - name: township_code
        description: '{{ doc("shared_column_township_code") }}'
      - name: township_name
        description: '{{ doc("shared_column_township_name") }}'
      - name: triad_code
        description: '{{ doc("shared_column_triad_code") }}'
      - name: triad_name
        description: '{{ doc("shared_column_triad_name") }}'
      - name: x_3435
        description: '{{ doc("shared_column_x_3435") }}'
      - name: y_3435
        description: '{{ doc("shared_column_y_3435") }}'
      - name: year
        description: '{{ doc("shared_column_year") }}'
      - name: zip_code
        description: ZIP code of the property

    tests:
      # Number of classes is consistent over time
      - count_is_consistent:
          name: vw_pin_universe_class_count_is_consistent_by_year
          group_column: year
          count_column: class
          config:
            error_if: ">24"
      # Number of towns is consistent over time
      - count_is_consistent:
          name: vw_pin_universe_township_code_count_is_consistent_by_year
          group_column: year
          count_column: township_code
      - unique_combination_of_columns:
          name: vw_pin_universe_unique_by_14_digit_pin_and_year
          combination_of_columns:
            - pin
            - year
      # TODO: Data completeness correlates with availability of spatial data
      # by year
